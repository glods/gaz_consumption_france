# ============================================================================
# IMPORTS AND CONFIGURATION
# ============================================================================

import os
import sys
import warnings
import yaml
import urllib.request
import gzip
import shutil
from pathlib import Path
from datetime import datetime

# Data processing
import pandas as pd
import numpy as np

# Spark
from pyspark.sql import SparkSession
from pyspark.sql import functions as F
from pyspark.sql.types import (
    StructType, StructField, StringType, IntegerType, 
    DoubleType, DateType, LongType
)
from pyspark.sql.window import Window

# Spark ML
from pyspark.ml import Pipeline
from pyspark.ml.feature import VectorAssembler, StandardScaler
from pyspark.ml.regression import LinearRegression, RandomForestRegressor
from pyspark.ml.evaluation import RegressionEvaluator

# Visualization
import matplotlib.pyplot as plt
import seaborn as sns

geopandas